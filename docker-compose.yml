version: "2.3"
services:

  nginx:
    image: b1f6c1c4/accounting-frontend
    ports:
      - "18080:443/tcp"
      - "18080:443/udp"
    volumes:
      - /data/accounting/certs:/opt/accounting/certs
      - /data/accounting/nginx-cache:/var/cache/nginx
      - /data/accounting/nginx-pid:/var/run
    networks:
      - prod

  server:
    image: b1f6c1c4/accounting-backend
    read_only: true
    environment:
      MONGO_URI: /opt/accounting/atlas/url
      MONGO_CERT: /opt/accounting/atlas/cert.pem
    volumes:
      - /data/accounting/atlas:/opt/accounting/atlas
      - /data/accounting/config.d:/opt/accounting/config.d
    networks:
      - prod

networks:
  prod:
    driver: bridge
